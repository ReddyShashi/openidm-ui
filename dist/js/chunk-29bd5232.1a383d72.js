/*!
 * Copyright 2019 ForgeRock AS. All Rights Reserved 
 *  Use of this code requires a commercial software license with ForgeRock AS. or with one of its affiliates. All use shall be exclusively subject to such license between the licensee and ForgeRock AS.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29bd5232"],{"1f49":function(t,e,a){},"2ba5":function(t,e,a){},"362a":function(t,e,a){"use strict";var i=a("3be0"),s=a.n(i);s.a},"3a90":function(t,e,a){},"3be0":function(t,e,a){},"49c6":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mb-3"},[a("div",{ref:"floatingLabelGroup",class:[{"form-label-password":t.reveal},"form-label-group","mb-0"]},["checkbox"===t.inputType?a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"},{name:"validate",rawName:"v-validate",value:t.validateRules,expression:"validateRules"}],ref:"input",class:[{polyfillPlaceholder:t.floatLabels,"is-invalid":t.errors.has(t.fieldName)&&t.showErrorState},"form-control"],attrs:{id:t.id,autofocus:t.autofocus,placeholder:t.label,"data-vv-as":t.label,"data-vv-validate-on":"submit",name:t.fieldName,type:"checkbox"},domProps:{checked:Array.isArray(t.inputValue)?t._i(t.inputValue,null)>-1:t.inputValue},on:{change:function(e){var a=t.inputValue,i=e.target,s=!!i.checked;if(Array.isArray(a)){var r=null,n=t._i(a,r);i.checked?n<0&&(t.inputValue=a.concat([r])):n>-1&&(t.inputValue=a.slice(0,n).concat(a.slice(n+1)))}else t.inputValue=s}}}):"radio"===t.inputType?a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"},{name:"validate",rawName:"v-validate",value:t.validateRules,expression:"validateRules"}],ref:"input",class:[{polyfillPlaceholder:t.floatLabels,"is-invalid":t.errors.has(t.fieldName)&&t.showErrorState},"form-control"],attrs:{id:t.id,autofocus:t.autofocus,placeholder:t.label,"data-vv-as":t.label,"data-vv-validate-on":"submit",name:t.fieldName,type:"radio"},domProps:{checked:t._q(t.inputValue,null)},on:{change:function(e){t.inputValue=null}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"},{name:"validate",rawName:"v-validate",value:t.validateRules,expression:"validateRules"}],ref:"input",class:[{polyfillPlaceholder:t.floatLabels,"is-invalid":t.errors.has(t.fieldName)&&t.showErrorState},"form-control"],attrs:{id:t.id,autofocus:t.autofocus,placeholder:t.label,"data-vv-as":t.label,"data-vv-validate-on":"submit",name:t.fieldName,type:t.inputType},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}}),t.reveal?a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.revealText}},[a("i",{class:[{"fa-eye-slash":!t.show},{"fa-eye":t.show},"fa"]})])]):t._e(),a("label",{attrs:{hidden:t.hideLabel,for:t.id}},[t._v(t._s(t.label))])]),t._t("validationError",[a("fr-validation-error",{attrs:{validatorErrors:t.errors,fieldName:t.fieldName}})])],2)},s=[],r=a("2ef0"),n=a.n(r),o=a("9588"),l={name:"Floating-Label-Input",components:{"fr-validation-error":o["a"]},props:{label:String,type:String,autofocus:String,fieldName:String,validateRules:[String,Object],reveal:Boolean,showErrorState:{type:Boolean,default:!0},defaultValue:{required:!1}},inject:["$validator"],data:function(){return{inputValue:"",id:null,floatLabels:!1,hideLabel:!0,inputType:this.type,show:!0}},beforeMount:function(){this.id="floatingLabelInput"+this._uid},mounted:function(){var t=this;n.a.delay(n.a.bind((function(){navigator.userAgent.indexOf("Edge")>=0?document.getElementById("".concat(t.id)).value.length&&(t.floatLabels=!0,t.inputValue=document.getElementById("".concat(t.id)).value):navigator.userAgent.indexOf("Chrome")>=0&&document.querySelectorAll("#".concat(t.id,":-webkit-autofill")).length>0&&(t.floatLabels=!0),t.hideLabel=!1}),this),400),this.defaultValue&&(this.inputValue=this.defaultValue),"true"===this.autofocus&&this.$refs.input.focus()},methods:{revealText:function(){"password"===this.inputType?(this.inputType="text",this.show=!1):(this.inputType="password",this.show=!0)}},watch:{inputValue:function(t){this.floatLabels=t.length>0,this.$emit("input",t)}}},c=l,u=(a("362a"),a("2877")),d=Object(u["a"])(c,i,s,!1,null,"7e7d904a",null);e["a"]=d.exports},5231:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{staticClass:"mb-3",attrs:{"no-body":""}},[t._t("list-group-header",[a("b-card-body",{staticClass:"py-4"},[a("h5",{class:[{"mb-4":t.subtitle,"mb-0":!t.subtitle},"card-title"]},[t._v(t._s(t.title))]),t.subtitle?a("h6",{staticClass:"card-subtitle mb-0 text-muted"},[t._v(t._s(t.subtitle))]):t._e()])]),a("b-list-group",{attrs:{flush:""}},[t._t("default")],2)],2)},s=[],r={name:"List-Group",props:{title:{type:String},subtitle:{type:String}},data:function(){return{}}},n=r,o=(a("8fef"),a("2877")),l=Object(o["a"])(n,i,s,!1,null,"1e1858be",null);e["a"]=l.exports},"5c32":function(t,e,a){"use strict";var i=a("2ba5"),s=a.n(i);s.a},7840:function(t,e,a){"use strict";var i=a("ca70"),s=a.n(i);s.a},"787a":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{class:["btn btn-primary d-flex align-items-center",{disabled:t.loading}],attrs:{type:"button"},on:{click:function(e){return t.$emit("click")}}},[a("span",{class:[{"align-self-start":!t.large,"m-auto":t.large}]},[t._v("\n        "+t._s(t.label)+"\n    ")]),a("span",{class:["fr-grow",{"fr-grow-in":t.loading}]},[a("transition",{attrs:{name:"fr-fade"}},[t.loading?a("clip-loader",{staticClass:"position-relative fr-clip-loader ml-3",attrs:{color:"white",size:"1rem"}}):t._e()],1)],1)])},s=[],r=a("8455"),n={name:"LoadingButton",components:{ClipLoader:r["ClipLoader"]},props:{label:String,loading:{type:Boolean,default:!1},large:{type:Boolean,default:!1}}},o=n,l=(a("5c32"),a("2877")),c=Object(l["a"])(o,i,s,!1,null,"2d05cc10",null);e["a"]=c.exports},8960:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("fr-list-group",{attrs:{title:t.$t("pages.profile.accountSecurity.title"),subtitle:t.$t("pages.profile.accountSecurity.subtitle")}},[!1===t.$root.applicationStore.state.platformMode?a("fr-edit-password",{on:{updateProfile:t.sendUpdateProfile}}):t._e(),t.isOnKBA&&!1===t.$root.userStore.state.internalUser?a("fr-edit-kba",{attrs:{kbaData:t.kbaData},on:{updateKBA:t.sendUpdateKBA}}):t._e()],1)},s=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("fr-list-item",{attrs:{collapsible:!0,panelShown:!1}},[a("div",{staticClass:"d-inline-flex w-100 media",attrs:{slot:"list-item-header"},slot:"list-item-header"},[a("div",{staticClass:"media-body align-self-center"},[a("h6",{staticClass:"my-0"},[t._v(t._s(t.$t("pages.profile.accountSecurity.securityQuestions")))])]),a("div",{staticClass:"d-flex ml-3 align-self-center"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showCancelButton,expression:"showCancelButton"}],ref:"cancel",staticClass:"btn btn-sm btn-link float-right btn-cancel",on:{click:function(e){return t.clearComponent()}}},[t._v(t._s(t.$t("common.form.cancel")))]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showCancelButton,expression:"!showCancelButton"}],staticClass:"btn btn-sm btn-link float-right btn-edit",on:{click:function(e){t.showCancelButton=!0}}},[t._v(t._s(t.$t("common.form.reset")))])])]),t.selected.length?a("div",{staticClass:"d-inline-flex w-100",attrs:{slot:"list-item-collapse-body"},slot:"list-item-collapse-body"},[a("b-form",{staticClass:"w-100"},[a("b-row",[a("b-col",{attrs:{sm:"8"}},[t._l(t.selected,(function(e,i){return a("fieldset",{key:i,staticClass:"pb-3"},[a("label",[t._v(t._s(t.$t("common.user.kba.question"))+" "+t._s(e.index))]),a("b-form-select",{staticClass:"mb-3",attrs:{options:t.selectOptions},model:{value:e.selected,callback:function(a){t.$set(e,"selected",a)},expression:"select.selected"}}),e&&e.selected===t.customIndex?a("div",{staticClass:"pb-3"},[a("label",[t._v(t._s(t.$t("pages.profile.accountSecurity.custom")))]),a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:[{"is-invalid":t.errors.has(t.$t("pages.profile.accountSecurity.custom")+e.index)},"form-control"],attrs:{type:"text","data-vv-validate-on":"submit",name:t.$t("pages.profile.accountSecurity.custom")+e.index},model:{value:e.custom,callback:function(a){t.$set(e,"custom","string"===typeof a?a.trim():a)},expression:"select.custom"}}),a("fr-validation-error",{attrs:{validatorErrors:t.errors,fieldName:t.$t("pages.profile.accountSecurity.custom")+e.index}})],1):t._e(),a("div",{staticClass:"form-group mb-0"},[a("label",[t._v(t._s(t.$t("common.user.kba.answer")))]),a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:[{"is-invalid":t.errors.has(t.$t("common.user.kba.answer")+e.index)},"form-control"],attrs:{type:"text","data-vv-validate-on":"submit","data-vv-as":t.$t("common.user.kba.answer"),name:t.$t("common.user.kba.answer")+e.index},model:{value:e.answer,callback:function(a){t.$set(e,"answer","string"===typeof a?a.trim():a)},expression:"select.answer"}}),a("fr-validation-error",{attrs:{validatorErrors:t.errors,fieldName:t.$t("common.user.kba.answer")+e.index}})],1),i!==t.selected.length-1?a("hr",{staticClass:"mb-3 mt-4"}):t._e()],1)})),a("fr-loading-button",{staticClass:"ld-ext-right mb-3",attrs:{type:"button",variant:"primary",label:t.$t("common.user.kba.saveQuestions"),loading:t.loading},on:{click:t.onSaveKBA}})],2)],1)],1)],1):t._e()])},n=[],o=a("2ef0"),l=a.n(o),c=a("9830"),u=a("787a"),d=a("9588"),p={name:"Edit-KBA",components:{"fr-list-item":c["a"],"fr-loading-button":u["a"],"fr-validation-error":d["a"]},$_veeValidate:{validator:"new"},props:["kbaData"],data:function(){return{questions:{},selectOptions:[],selected:[],customIndex:null,loading:!1,showCancelButton:!1}},mounted:function(){this.questions=this.kbaData.questions,this.initializeForm(this.kbaData.minimumAnswersToDefine)},methods:{initializeForm:function(t){var e=this,a=this.$i18n,i=a.locale,s=a.fallbackLocale;l.a.times(t,(function(t){e.selected.push({selected:null,index:t+1,answer:"",custom:""})})),this.selectOptions=l.a.map(this.questions,(function(t,e){return{value:e,text:t[i]||t[s],disabled:!0}})),this.customIndex=this.selectOptions.length+1,this.selectOptions.unshift({value:null,text:this.$t("common.user.kba.selectQuestion"),disabled:!0}),this.selectOptions.push({value:this.customIndex,text:this.$t("common.user.kba.custom"),disabled:!1})},generatePatch:function(){var t=l.a.map(this.selected,(function(t){return t.custom?{answer:t.answer,customQuestion:t.custom}:{answer:t.answer,questionId:t.selected}}));return[{operation:"replace",field:"/kbaInfo",value:t}]},clearComponent:function(){this.loading=!1,this.questions={},this.selectOptions=[],this.selected=[],this.customIndex=null,this.showCancelButton=!1,this.questions=this.kbaData.questions,this.initializeForm(this.kbaData.minimumAnswersToDefine),this.errors.clear()},onSaveKBA:function(){var t=this;this.isValid().then((function(e){e&&(t.loading=!0,t.$emit("updateKBA",t.generatePatch(),{onSuccess:function(){t.$refs.cancel.click()}}))}))},isValid:function(){return this.$validator.validateAll()}},watch:{selected:{handler:function(t){var e=this,a=l.a.map(this.selected,(function(t){if(null!==t.selected&&t.selected!==e.customIndex)return t.selected}));l.a.each(this.selectOptions,(function(t){l.a.includes(a,t.value)||null===t.value?t.disabled=!0:t.disabled=!1}))},deep:!0},kbaData:{deep:!0,handler:l.a.noop}}},f=p,m=a("2877"),h=Object(m["a"])(f,r,n,!1,null,null,null),v=h.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("fr-list-item",{attrs:{collapsible:!0,panelShown:!1}},[a("div",{staticClass:"d-inline-flex w-100 media",attrs:{slot:"list-item-header"},slot:"list-item-header"},[a("div",{staticClass:"media-body align-self-center"},[a("h6",[t._v(t._s(t.$t("pages.profile.accountSecurity.password")))])]),a("div",{staticClass:"d-flex ml-3 align-self-center"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showCancelButton,expression:"showCancelButton"}],ref:"cancel",staticClass:"btn btn-sm btn-link float-right btn-cancel",on:{click:function(e){return t.clearComponent()}}},[t._v(t._s(t.$t("common.form.cancel")))]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showCancelButton,expression:"!showCancelButton"}],staticClass:"btn btn-sm btn-link float-right btn-edit",on:{click:function(e){t.showCancelButton=!0}}},[t._v(t._s(t.$t("common.form.reset")))])])]),a("div",{staticClass:"d-inline-flex w-100",attrs:{slot:"list-item-collapse-body"},slot:"list-item-collapse-body"},[a("b-form",{staticClass:"w-100"},[a("b-row",[a("b-col",{attrs:{sm:"8"}},[a("b-form-group",[a("label",{attrs:{for:"currentPassword"}},[t._v(t._s(t.$t("pages.profile.accountSecurity.currentPassword")))]),a("div",{staticClass:"form-label-password form-label-group mb-0"},[a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:[{"is-invalid":t.errors.has("currentPassword")},"form-control"],attrs:{id:"currentPassword",name:"currentPassword","data-vv-validate-on":"submit","data-vv-as":t.$t("pages.profile.accountSecurity.currentPassword"),type:t.inputCurrent},model:{value:t.currentPassword,callback:function(e){t.currentPassword=e},expression:"currentPassword"}}),a("div",{staticClass:"input-group-append"},[a("b-btn",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.revealCurrent}},[a("i",{class:[{"fa-eye-slash":!t.showCurrent},{"fa-eye":t.showCurrent},"fa"]})])],1)],1),a("fr-validation-error",{attrs:{validatorErrors:t.errors,fieldName:"currentPassword"}})],1),a("fr-password-policy-input",{attrs:{policyApi:this.$root.userStore.state.managedResource+"/"+t.userId},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}},[a("b-form-group",{staticClass:"mb-3",attrs:{slot:"custom-input"},slot:"custom-input"},[a("label",{attrs:{for:"newPassword"}},[t._v(t._s(t.$t("pages.profile.accountSecurity.newPassword")))]),a("div",{staticClass:"form-label-password form-label-group mb-0"},[a("b-form-input",{directives:[{name:"validate",rawName:"v-validate.initial",value:"required|policy",expression:"'required|policy'",modifiers:{initial:!0}}],attrs:{id:"newPassword",type:t.inputNew,name:"password"},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.revealNew}},[a("i",{class:[{"fa-eye-slash":!t.showNew},{"fa-eye":t.showNew},"fa"]})])])],1)])],1),a("fr-loading-button",{staticClass:"ld-ext-right mb-3",attrs:{type:"button",variant:"primary",label:t.$t("pages.profile.accountSecurity.savePassword"),loading:t.loading},on:{click:t.onSavePassword}}),this.$root.applicationStore.state.passwordReset?a("div",{staticClass:"text-nowrap pb-2"},[t._v(t._s(t.$t("pages.profile.accountSecurity.rememberPassword"))+" "),a("router-link",{attrs:{to:"PasswordReset"}},[t._v(t._s(t.$t("pages.profile.accountSecurity.resetPassword")))])],1):t._e()],1)],1)],1)],1)])},w=[],y=a("f8f2"),g={$_veeValidate:{validator:"new"},name:"Edit-Password",components:{"fr-list-item":c["a"],"fr-loading-button":u["a"],"fr-password-policy-input":y["a"],"fr-validation-error":d["a"]},data:function(){return{currentPassword:"",newPassword:"",loading:!1,showNew:!0,showCurrent:!0,inputCurrent:"password",inputNew:"password",userId:this.$root.userStore.getUserState().userId,showCancelButton:!1}},methods:{clearComponent:function(){this.currentPassword="",this.newPassword="",this.errors.clear(),this.showCancelButton=!1},resetComponent:function(){this.loading=!1,this.currentPassword="",this.newPassword="",this.$refs.cancel.click()},displayError:function(t){403===t.response.status&&this.errors.add({field:"currentPassword",msg:"Incorrect password provided"})},onSavePassword:function(){var t=this,e={"X-Requested-With":"XMLHttpRequest","X-OpenIDM-Reauth-Password":this.encodeRFC5987IfNecessary(this.currentPassword)},a=[{operation:"add",field:"/password",value:this.newPassword}],i=this.resetComponent.bind(this),s=this.displayError.bind(this);this.errors.clear(),this.$validator.validateAll().then((function(r){r?t.$emit("updateProfile",a,{headers:e,onSuccess:i,onError:s}):t.displayNotification("error",t.$t("pages.profile.accountSecurity.invalidPassword"))}))},validate:function(){return this.$validator.validateAll()},revealNew:function(){"password"===this.inputNew?(this.inputNew="text",this.showNew=!1):(this.inputNew="password",this.showNew=!0)},revealCurrent:function(){"password"===this.inputCurrent?(this.inputCurrent="text",this.showCurrent=!1):(this.inputCurrent="password",this.showCurrent=!0)}}},_=g,C=Object(m["a"])(_,b,w,!1,null,null,null),x=C.exports,P=a("5231"),$={name:"Account-Security",data:function(){return{isOnKBA:!1,kbaData:{}}},components:{"fr-list-group":P["a"],"fr-edit-kba":v,"fr-edit-password":x},methods:{sendUpdateKBA:function(t,e){this.$emit("updateKBA",t,e)},sendUpdateProfile:function(t,e){this.$emit("updateProfile",t,e)}},mounted:function(){var t=this,e=this.getRequestService({headers:this.getAnonymousHeaders()});e.get("selfservice/kba").then((function(e){t.isOnKBA=!0,t.kbaData=e.data})).catch((function(){t.isOnKBA=!1}))}},k=$,N=Object(m["a"])(k,i,s,!1,null,null,null);e["default"]=N.exports},"8fef":function(t,e,a){"use strict";var i=a("3a90"),s=a.n(i);s.a},9588:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.validatorErrors.has(t.fieldName),expression:"validatorErrors.has(fieldName)"}],staticClass:"fr-validation-requirements text-left"},[a("span",{staticClass:"text-danger"},[t._v(t._s(t.validatorErrors.first(t.fieldName)))])])},s=[],r={name:"Validation-Error",props:["validatorErrors","fieldName"]},n=r,o=a("2877"),l=Object(o["a"])(n,i,s,!1,null,"ad00d232",null);e["a"]=l.exports},9830:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.collapsible?a("div",{staticClass:"collapsible"},[a("b-list-group-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.toggleId,expression:"toggleId"}],class:[{"list-item-cursor":!1===t.collapsible}],attrs:{href:"#"}},[a("div",{staticClass:"media"},[t._t("list-item-header")],2)]),a("b-collapse",{attrs:{id:t.id,visible:t.panelShown},on:{hide:function(e){return t.$emit("hide")},show:function(e){return t.$emit("show")},hidden:function(e){return t.$emit("hidden")},shown:function(e){return t.$emit("shown")}}},[a("b-card-body",{staticClass:"pt-3"},[t._t("list-item-collapse-body")],2)],1)],1):a("div",{class:[{"fr-hover-item":t.hoverItem}],on:{click:function(e){return t.$emit("row-click")}}},[a("b-list-group-item",{staticClass:"noncollapse"},[a("div",{staticClass:"media"},[t._t("list-item-header")],2)]),t.panelShown?a("b-card-body",{staticClass:"pt-3"},[t._t("list-item-collapse-body")],2):t._e()],1)},s=[],r={name:"List-Item",props:{collapsible:{type:Boolean,default:!1},panelShown:{type:Boolean,default:!1},hoverItem:{type:Boolean,default:!1}},data:function(){return{id:null}},beforeMount:function(){this.id="listItem"+this._uid},computed:{toggleId:function(){return this.collapsible?this.id:null}}},n=r,o=(a("a617"),a("2877")),l=Object(o["a"])(n,i,s,!1,null,"cc9f6ae4",null);e["a"]=l.exports},a617:function(t,e,a){"use strict";var i=a("1f49"),s=a.n(i);s.a},ca70:function(t,e,a){},f8f2:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-form-group",{staticClass:"mb-0"},[t.customInput?[t._t("custom-input"),a("fr-policy-panel",{attrs:{policies:t.policies,policyFailures:t.showDefaultPolicyFailures?t.defaultPolicyFailures:t.policyFailures}})]:t._t("input-with-validation-panel",[a("fr-floating-label-input",{directives:[{name:"validate",rawName:"v-validate.initial",value:"required|policy",expression:"'required|policy'",modifiers:{initial:!0}}],attrs:{name:"password",fieldName:"password",type:"password",label:t.label||t.$t("common.placeholders.password"),reveal:!0,showErrorState:!1},on:{input:function(e){return t.$emit("input",e)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[a("fr-policy-panel",{attrs:{slot:"validationError",policies:t.policies,policyFailures:t.showDefaultPolicyFailures?t.defaultPolicyFailures:t.policyFailures},slot:"validationError"})],1)])],2)},s=[],r=a("2ef0"),n=a.n(r),o=a("49c6"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card border-0 mt-3"},[a("transition",{attrs:{name:"fade",mode:"out-in",duration:150}},[t.isLoading?t._e():[t.isValid?a("div",{staticClass:"alert alert-success mt-1",attrs:{role:"alert"}},[a("i",{staticClass:"fa fa-check-circle"}),t._v(" "+t._s(t.$t("common.policyValidationMessages.successMessages.password"))+"\n            ")]):a("ul",{staticClass:"text-left pl-3"},t._l(t.policies,(function(e){return a("li",{key:e.policyId,class:[{"fr-valid":!t.includes(t.policyFailures,e.name)},"text-primary fr-policy-list-item"]},[a("small",{staticClass:"text-body"},[t._v(t._s(t.translate(e)))])])})),0)]],2)],1)},c=[],u={name:"PolicyPanel",props:["policies","policyFailures"],data:function(){return{}},computed:{isValid:function(){return n.a.isArray(this.policyFailures)&&n.a.isEmpty(this.policyFailures)},isLoading:function(){return"loading"===this.policyFailures||!1===this.policyFailures}},methods:{translate:function(t){var e="common.policyValidationMessages.".concat(t.name);return this.$t(e,t.params)},includes:n.a.includes},watch:{policyFailures:function(t){this.policyFailures=t}}},d=u,p=(a("7840"),a("2877")),f=Object(p["a"])(d,l,c,!1,null,"8583d52e",null),m=f.exports,h={name:"PolicyPasswordInput",inject:["$validator"],components:{"fr-floating-label-input":o["a"],"fr-policy-panel":m},props:{policyApi:{required:!0,type:String},defaultPolicyFailures:{required:!1,type:Array},value:String,label:String,exclude:{required:!1,type:Array,default:function(){var t=this.policyApi;return[{name:"REQUIRED",predicate:function(t){return n.a.includes(t,"REQUIRED")&&n.a.includes(t,"MIN_LENGTH")}},{name:"IS_NEW",predicate:function(e){return"selfservice/registration"===t}},"VALID_TYPE","CANNOT_CONTAIN_OTHERS"]}}},data:function(){return{policies:[],password:this.value,failedExcludedPolicies:[],showDefaultPolicyFailures:!1}},watch:{failedExcludedPolicies:function(t){var e=t[0];if(e){var a=this.$t("common.policyValidationMessages.".concat(e.policyRequirements[0].policyRequirement),e.policyRequirements[0].params),i="".concat(this.$t("common.policyValidationMessages.policyValidationFailed",{property:e.property}),": ").concat(a);this.displayNotification("error",i),this.failedExcludedPolicies=[]}},defaultPolicyFailures:function(t){this.showDefaultPolicyFailures=!0}},computed:{policyFailures:function(){var t=this.errors.firstByRule("password","policy");return n.a.isUndefined(this.fields.password)?"loading":n.a.isNull(t)&&this.fields.password.valid?[]:t},customInput:function(){return!n.a.isUndefined(this.$slots["custom-input"])}},methods:{isPasswordPolicyItem:n.a.curry((function(t,e){return!n.a.isEmpty(e[t].match("password"))})),toSimplePolicyObject:function(t){var e=t.policyRequirements,a=t.params,i=n.a.first(e);return n.a.isUndefined(i)?{}:{name:i,params:a}},toPolicyNames:function(t){var e=t.failedPolicyRequirements||[],a=e.filter(this.isPasswordPolicyItem("property")).map((function(t){return n.a.at(t,["policyRequirements[0].policyRequirement"])}));return n.a.flatten(a)},makeExclusions:function(t){var e,a;e=t&&t.policyRequirements?t.policyRequirements:[],a=t&&t.policies?t.policies:[];var i=function(t){return n.a.reject(a,(function(e){return n.a.first(e.policyRequirements)===t}))};return this.exclude.forEach((function(t){n.a.isObject(t)?t.predicate(e)&&(a=i(t.name)):n.a.isString(t)&&n.a.includes(e,t)&&(a=i(t))})),Object.assign({},t,{policyRequirements:e,policies:a})},formatPayload:function(t){return this.policyApi.match("registration")?{user:{password:t}}:{password:t}},getAction:function(){return this.policyApi.match("selfservice")?"validateObject":"validateProperty"}},created:function(){var t=this,e=this.getAnonymousHeaders(),a=this.getRequestService({headers:e}),i=this.formatPayload.bind(this),s=function(t){var e=this,s=i(t);return a.post("/policy/".concat(this.policyApi,"/?_action=").concat(this.getAction()),s).then((function(t){var a=t.data;return a.failedPolicyRequirements&&n.a.map(a.failedPolicyRequirements,(function(t){"password"===t.property&&(e.showDefaultPolicyFailures=!1,n.a.includes(e.exclude,t.policyRequirements[0].policyRequirement)&&e.failedExcludedPolicies.push(t))})),e.toPolicyNames(a)})).catch((function(){e.displayNotification("error",e.$t("common.policyValidationMessages.policyServiceError"))}))}.bind(this);this.$validator.extend("policy",{validate:function(t,e){return s(t).then((function(t){return{valid:n.a.isEmpty(t),data:t}}))},getMessage:function(t,e,a){return a}}),a.get("/policy/".concat(this.policyApi)).then((function(e){var a=e.data;return n.a.head(a.properties.filter(t.isPasswordPolicyItem("name")))})).then((function(e){return t.makeExclusions(e)})).then((function(e){var a=e.policies;t.policies=a.map(t.toSimplePolicyObject).filter((function(t){return!n.a.isEmpty(t)}))})).catch((function(){t.displayNotification("error",t.$t("common.policyValidationMessages.policyServiceError.".concat(t.policyApi))),t.$router.push("/login")}))}},v=h,b=Object(p["a"])(v,i,s,!1,null,null,null);e["a"]=b.exports}}]);
//# sourceMappingURL=chunk-29bd5232.1a383d72.js.map