/*!
 * Copyright 2019 ForgeRock AS. All Rights Reserved 
 *  Use of this code requires a commercial software license with ForgeRock AS. or with one of its affiliates. All use shall be exclusively subject to such license between the licensee and ForgeRock AS.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-642899e2"],{"0602":function(e,t,s){},"0606":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.imageFound?s("b-img",{attrs:{src:e.src,width:e.width,height:e.width,alt:e.alt}}):s("span",{staticClass:"icon-holder p-2 d-flex bg-light border rounded"},[s("i",{class:["fa",e.fallback,"fa-lg text-dark mt-auto"]})])],1)},r=[],i=s("2ef0"),o=s.n(i),n=s("bc3a"),c=s.n(n),l={name:"Image-Fallback",props:["src","width","height","alt","fallback"],data:function(){return{imageFound:!1}},mounted:function(){var e=this;!o.a.isNull(this.src)&&!o.a.isUndefined(this.src)&&this.src.length>0?c.a.get("".concat(this.src)).then((function(t){var s=t.status;e.imageFound=200===s})).catch((function(t){t&&(e.imageFound=!1)})):this.imageFound=!1}},u=l,d=(s("c932"),s("2877")),h=Object(d["a"])(u,a,r,!1,null,"1c629ce4",null);t["a"]=h.exports},"0acf":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{attrs:{fluid:""}},[e.requestsLoaded?[e.resources.length>0?a("b-tabs",{staticClass:"mt-4",on:{click:e.testForReload}},[a("b-tab",{attrs:{title:"Resources",active:""}},[a("fr-resources",{attrs:{resources:e.resources},on:{renderShareModal:e.renderShareModal,renderUnshareModal:e.renderUnshareModal}})],1),e.activity.length>0?a("b-tab",{attrs:{title:"Activity"},on:{click:e.testForReload}},[a("fr-activity",{attrs:{umaHistory:e.umaHistory}})],1):e._e(),e.requests.length>0?a("b-tab",{attrs:{title:"Requests"}},[a("template",{slot:"title"},[e._v("\n                    "+e._s(e.$t("pages.uma.notifications.requests"))+" "),a("b-badge",{attrs:{pill:"",variant:"danger"}},[e._v(e._s(e.requests.length))])],1),a("fr-requests",{attrs:{requests:e.requests},on:{finalizeResourceAccess:e.finalizeResourceAccess}})],2):e._e()],1):a("div",[a("fr-center-card",{staticClass:"mt-5",attrs:{showLogo:!1}},[a("b-card-body",{attrs:{slot:"center-card-body"},slot:"center-card-body"},[a("img",{staticClass:"mb-4",staticStyle:{width:"150px"},attrs:{src:s("1824"),alt:e.$t("common.form.logo")}}),a("h5",{staticClass:"h5"},[e._v(e._s(e.$t("pages.uma.resources.noDataState")))])])],1)],1),e.resource?a("fr-share",{attrs:{resource:e.resource},on:{shareResource:e.shareResource,renderUnshareModal:e.renderUnshareModal,modifyResource:e.modifyResource}}):e._e(),a("fr-unshare",{attrs:{resourceId:e.resourceId,resourceName:e.resourceName},on:{unshareResource:e.unshareResource}})]:e._e()],2)},r=[],i=s("2ef0"),o=s.n(i),n=s("13bf"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._l(e.activityGroups,(function(t,a){return[s("fr-list-group",{key:"activityGroup-"+a},[s("div",{staticClass:"card-body m-0 py-4",attrs:{slot:"list-group-header"},slot:"list-group-header"},[s("h6",{staticClass:"card-title mb-0"},[e._v(e._s(e.formatDateTitle(t.day)))])]),e._l(t.activities,(function(t){return s("fr-list-item",{key:t._id,attrs:{collapsible:!1,panelShown:!1,hoverItem:!1}},[s("template",{staticClass:"d-inline-flex w-100",slot:"list-item-header"},[s("div",{staticClass:"flex-grow-1 media-body"},[s("span",{staticClass:"activity-type"},[e._v(e._s(e.$t("pages.uma.activity."+t.type,{requestingParty:t.requestingPartyName})))]),s("button",{staticClass:"m-0 p-0 btn btn-link text-capitalize",attrs:{type:"button"},on:{click:function(s){return e.$emit("resourceSetClick",t._id)}}},[e._v(e._s(t.resourceSetName))]),s("small",{staticClass:"d-block text-muted subtext"},[e._v(e._s(e.formatTime(t.eventTime)))])]),s("fr-fallback-image",{attrs:{src:t.icon_uri,height:"30",width:"30",fallback:"fa-file-alt"}})],1)],2)}))],2)]}))],2)},l=[],u=s("0606"),d=s("5231"),h=s("9830"),m=s("c1df"),f=s.n(m),p={name:"Uma-Activity",components:{"fr-list-group":d["a"],"fr-list-item":h["a"],"fr-fallback-image":u["a"]},props:{umaHistory:{required:!0,type:Array}},data:function(){return{}},computed:{activityGroups:function(){var e=o.a.clone(this.umaHistory),t=e.sort((function(e,t){return e.eventTime-t.eventTime})).reverse(),s=o.a.groupBy(t,(function(e){return f()(e.eventTime).format("YYYY-MM-DD")})),a=o.a.keys(s).map((function(e){return{day:e,activities:s[e]}}));return o.a.sortBy(a,(function(e){var t=e.day;return f()(t)})).reverse()}},methods:{formatDateTitle:function(e){return f()(e).format("dddd, MMMM DD, YYYY")},formatTime:function(e){var t=f()(e);return t.isSame(f()(),"day")?t.fromNow():t.format("LT")}}},v=p,g=s("2877"),b=Object(g["a"])(v,c,l,!1,null,null,null),_=b.exports,y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[[s("div",{attrs:{id:"listView"}},[s("b-card",{staticClass:"mt-4",attrs:{"no-body":""}},[s("b-list-group",{attrs:{flush:""}},e._l(e.requests,(function(t,a){return s("b-list-group-item",{key:a},[s("div",{staticClass:"d-sm-flex"},[s("div",{staticClass:"media-body align-self-center mb-2 mb-sm-0"},[s("div",{staticClass:"mb-2"},[s("small",[s("strong",[e._v(e._s(t.user))]),e._v(" "+e._s(e.$t("pages.uma.requests.requestedAccess")))])]),s("div",{staticClass:"media mb-1"},[s("div",{staticClass:"d-flex mr-2 align-self-center"},[t.icon_uri?s("fr-fallback-image",{attrs:{src:t.icon_uri,height:"30",width:"30",fallback:"fa-file-alt"}}):e._e()],1),s("div",{staticClass:"media-body align-self-center"},[s("div",{staticClass:"media-body align-self-center"},[e._v("\n                                            "+e._s(t.resource)+"\n                                        ")])])]),s("small",{staticClass:"text-muted"},[e._v(e._s(e._f("formatTime")(t.when)))])]),t.decision?e._e():s("div",{staticClass:"d-flex justify-content-start ml-sm-3 align-self-center"},[s("a",{staticClass:"pr-3",attrs:{href:"#"},on:{click:function(s){return e.finalizeAccess(t,a,"approve")}}},[e._v(e._s(e.$t("pages.uma.requests.allow")))]),s("a",{staticClass:"px-2",attrs:{href:"#"},on:{click:function(s){return e.finalizeAccess(t,a,"deny")}}},[e._v(e._s(e.$t("pages.uma.requests.deny")))])]),t.decision?s("div",{staticClass:"d-flex justify-content-start ml-sm-3 align-self-center"},[t.allowed?s("div",{staticClass:"allow text-success"},[s("i",{staticClass:"fa fa-check fa-fw"}),e._v(" "+e._s(e.$t("pages.uma.requests.allowed"))+"\n                                ")]):e._e(),t.allowed?e._e():s("div",{staticClass:"deny text-danger"},[s("i",{staticClass:"fa fa-ban fa-fw"}),e._v(" "+e._s(e.$t("pages.uma.requests.denied"))+"\n                                ")])]):e._e()])])})),1)],1)],1)]],2)},C=[],w={name:"Requests",components:{"fr-fallback-image":u["a"]},props:["requests"],filters:{formatTime:function(e){var t=f()(e);return t.isSame(f()(),"day")?t.fromNow():t.format("LT")}},methods:{finalizeAccess:function(e,t,s){var a=this;this.requests[t].decision=!0,this.$emit("finalizeResourceAccess",e._id,s,{scopes:e.permissions,onSuccess:function(){"approve"===s&&(a.requests[t].allowed=!0)}})}}},k=w,x=Object(g["a"])(k,y,C,!1,null,"034b6c74",null),$=x.exports,S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[[s("div",{staticClass:"btn-toolbar row mb-4",attrs:{role:"toolbar","aria-label":"Toolbar with button groups"}},[s("div",{staticClass:"input-group col-sm-4"},[e._m(0),s("input",{directives:[{name:"model",rawName:"v-model",value:e.resourceFilter,expression:"resourceFilter"}],staticClass:"form-control",attrs:{type:"text","aria-label":"Search","aria-describedby":"btnGroupAddon",placeholder:e.$t("pages.uma.resources.search")},domProps:{value:e.resourceFilter},on:{input:function(t){t.target.composing||(e.resourceFilter=t.target.value)}}})]),s("div",{staticClass:"col"},[s("b-dropdown",{staticClass:"float-right text-muted",attrs:{variant:"link",right:""}},[s("template",{slot:"button-content"},[s("span",{staticClass:"text-muted"},[this.viewgrid?e._e():s("i",{staticClass:"fa fa-list"}),this.viewgrid?s("i",{staticClass:"fa fa-th"}):e._e()])]),s("b-dropdown-header",[e._v(e._s(e.$t("pages.uma.resources.viewAs")))]),s("b-dropdown-item",{attrs:{href:"#"},on:{click:e.toggleGrid}},[s("div",{staticClass:"media"},[s("div",{staticClass:"d-flex align-self-center text-center",staticStyle:{"min-width":"1.5rem"}},[this.viewgrid?e._e():s("i",{staticClass:"fa fa-check text-success"})]),s("div",{staticClass:"media-body"},[e._v(e._s(e.$t("pages.uma.resources.list")))]),s("div",{staticClass:"d-flex ml-3 align-self-center text-muted"},[s("i",{staticClass:"fa fa-list"})])])]),s("b-dropdown-item",{attrs:{href:"#"},on:{click:e.toggleGrid}},[s("div",{staticClass:"media"},[s("div",{staticClass:"d-flex align-self-center text-center",staticStyle:{"min-width":"1.5rem"}},[this.viewgrid?s("i",{staticClass:"fa fa-check text-success"}):e._e()]),s("div",{staticClass:"media-body"},[e._v(e._s(e.$t("pages.uma.resources.grid")))]),s("div",{staticClass:"d-flex ml-3 align-self-center text-muted"},[s("i",{staticClass:"fa fa-th"})])])])],2)],1)]),this.viewgrid?e._e():s("div",{attrs:{id:"listView"}},[s("b-card",{staticClass:"my-4",attrs:{"no-body":""}},[s("b-list-group",{attrs:{flush:""}},e._l(e.filteredResources,(function(t,a){return s("b-list-group-item",{key:"listResource-"+a},[s("div",{staticClass:"d-sm-flex"},[s("div",{staticClass:"media-body"},[s("div",{staticClass:"media mb-2 mb-sm-0"},[s("div",{staticClass:"d-flex mr-3 align-self-top"},[s("fr-fallback-image",{attrs:{src:t.icon_uri,height:40,width:40,fallback:"fa-file-alt fa-2x m-auto pt-1 pb-1"}})],1),s("div",{staticClass:"d-sm-flex media-body align-self-center"},[s("div",{staticClass:"media-body mb-2 mb-sm-0"},[s("div",{staticClass:"my-0"},[e._v(e._s(t.name))]),t.policy?t.policy.permissions.length>1?s("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.sharedWithPeople",{numberOf:t.policy.permissions.length})))]):s("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.sharedWithPerson")))]):s("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.resourceNotShared")))])])])])]),s("div",{staticClass:"d-flex justify-content-start justify-content-sm-start ml-sm-3 align-self-center"},[s("div",{staticClass:"d-sm-none"},[s("a",{staticClass:"align-self-center pr-3",attrs:{href:"#"},on:{click:function(s){return e.renderShareModal(t)}}},[e._v(e._s(e.$t("pages.uma.resources.share")))]),s("a",{staticClass:"align-self-center pr-3",attrs:{href:"#"},on:{click:function(s){return e.renderUnshareModal(t.name,t._id)}}},[e._v(e._s(e.$t("pages.uma.resources.unshare")))])]),s("div",{staticClass:"d-none d-sm-flex"},[s("a",{staticClass:"align-self-center pr-3",attrs:{href:"#"},on:{click:function(s){return e.renderShareModal(t)}}},[e._v(e._s(e.$t("pages.uma.resources.share")))]),t.policy&&t.policy.permissions.length>0?s("a",{staticClass:"align-self-center pr-3",attrs:{href:"#"},on:{click:function(s){return e.renderUnshareModal(t.name,t._id)}}},[e._v(e._s(e.$t("pages.uma.resources.unshare")))]):e._e()])])])])})),1)],1)],1),this.viewgrid?s("div",{attrs:{id:"gridView"}},[s("div",{staticClass:"row"},e._l(e.filteredResources,(function(t,a){return s("div",{key:"viewResource-"+a,staticClass:"col-sm-6 col-md-3"},[s("div",{staticClass:"card text-center mb-4"},[s("div",{staticClass:"card-header py-0 px-1 border-0"},[s("b-dropdown",{staticClass:"fr-card-menu-link float-right",attrs:{variant:"link",right:"","no-caret":""}},[s("template",{slot:"button-content"},[s("span",{staticClass:"text-muted"},[s("i",{staticClass:"fa fa-ellipsis-h"})])]),s("b-dropdown-item",{attrs:{href:"#"},on:{click:function(s){return e.renderShareModal(t)}}},[e._v(e._s(e.$t("pages.uma.resources.share")))]),s("b-dropdown-item",{attrs:{href:"#"},on:{click:function(s){return e.renderUnshareModal(t.name,t._id)}}},[e._v(e._s(e.$t("pages.uma.resources.unshare")))])],2)],1),s("div",{staticClass:"card-body pt-0"},[s("fr-fallback-image",{staticClass:"pl-5 pr-5 pt-3 mb-3",attrs:{src:t.icon_uri,width:86,height:86,fallback:"fa-file-alt fa-3x m-auto pt-3 pb-3"}}),s("h5",{staticClass:"card-title text-truncate"},[e._v(e._s(t.name))]),s("div",{staticClass:"card-text"},[t.policy?t.policy.permissions.length>1?s("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.sharedWithPeople",{numberOf:t.policy.permissions.length})))]):s("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.sharedWithPerson")))]):s("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.resourceNotShared")))])])],1)])])})),0)]):e._e()]],2)},M=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"input-group-prepend"},[s("div",{staticClass:"input-group-text",attrs:{id:"btnGroupAddon"}},[s("i",{staticClass:"fa fa-search"})])])}],R={name:"Resources",components:{"fr-fallback-image":u["a"]},data:function(){return{viewgrid:!1,showModalActions:!1,newshare:"",resourceFilter:""}},props:["resources"],methods:{renderShareModal:function(e){this.$emit("renderShareModal",e)},renderUnshareModal:function(e,t){this.$emit("renderUnshareModal",e,t)},toggleGrid:function(){this.viewgrid=!this.viewgrid}},computed:{filteredResources:function(){var e=this;return o.a.filter(this.resources,(function(t){return t.name.includes(e.resourceFilter)}))}}},q=R,N=Object(g["a"])(q,S,M,!1,null,"08b33eec",null),D=N.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{ref:"fsModal",attrs:{id:"shareModal","cancel-variant":"outline-secondary"},on:{hide:e.resetModal},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.validateResource(t))}}},[a("div",{staticClass:"d-flex w-100 h-100",attrs:{slot:"modal-header"},slot:"modal-header"},[a("div",{staticClass:"media"},[a("div",{staticClass:"d-flex mr-3 align-self-center"},[a("fr-fallback-image",{attrs:{src:e.resource.icon_uri,height:40,width:40,fallback:"fa-file-alt"}})],1),a("div",{staticClass:"media-body align-self-center"},[a("h6",{staticClass:"my-0"},[e._v(e._s(e.resource.name))]),e.resource.policy?e.resource.policy.permissions.length>1?a("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.sharedWithPeople",{numberOf:e.resource.policy.permissions.length})))]):a("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.sharedWithPerson")))]):a("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("pages.uma.resources.resourceNotShared")))])])]),a("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:e.hideModal}},[a("i",{staticClass:"fa fa-times"})])]),a("div",{staticClass:"form-group"},[a("b-input-group",[a("b-form-input",{attrs:{placeholder:e.$t("pages.uma.resources.shareWith")},model:{value:e.newShare,callback:function(t){e.newShare=t},expression:"newShare"}}),a("b-dropdown",{attrs:{slot:"append",text:e.text,variant:"outline-secondary",size:"sm"},slot:"append"},[a("form",{staticClass:"px-4 py-2",on:{click:function(e){e.stopPropagation()}}},[e.resource.scopes?e._l(e.resource.scopes,(function(t,s){return a("div",{key:s,staticClass:"form-check mb-1"},[a("input",{staticClass:"form-check-input mr-1",attrs:{type:"checkbox",id:"viewCheck"},domProps:{checked:e.newScopes[t]},on:{click:function(s){e.newScopes[t]=!e.newScopes[t]}}}),a("label",{staticClass:"form-check-label",attrs:{for:"viewCheck"}},[e._v(e._s(t))])])})):e._e()],2)])],1)],1),a("div",{class:[{"d-none":this.newShare}]},[e.resource.policy&&e.resource.policy.permissions?a("ul",{staticClass:"list-unstyled"},e._l(e.resource.policy.permissions,(function(t,r){return a("li",{key:r,staticClass:"media py-2"},[a("b-img",{staticClass:"mr-3",attrs:{src:s("dfb4"),rounded:"circle",width:"34",height:"34",alt:"avatar"}}),a("div",{staticClass:"media-body"},[a("h6",{staticClass:"mt-2"},[e._v(e._s(t.subject))])]),a("div",{staticClass:"d-flex ml-3 align-self-center"},[a("b-dropdown",{attrs:{id:"ddown1",text:e.text,variant:"link",size:"sm",right:"","toggle-class":"dropdown-toggle"}},[a("template",{staticClass:"dropdown-toggle",slot:"button-content"},[a("span",{staticClass:"d-none d-sm-inline"},[e._v("Can "+e._s(t.scopes.join(", ")))])]),a("form",{staticClass:"px-4 py-2",on:{click:function(e){e.stopPropagation()}}},e._l(e.newScopes,(function(s,r){return a("div",{key:r,staticClass:"form-check mb-1"},[a("input",{staticClass:"form-check-input mr-1",attrs:{type:"checkbox",id:"viewCheck"},domProps:{checked:t.scopes.includes(r)},on:{click:function(s){return e.modifyResource(t.subject,r)}}}),a("label",{staticClass:"form-check-label",attrs:{for:"viewCheck"}},[e._v(e._s(r))])])})),0),a("b-dropdown-divider"),a("b-dropdown-item",[a("span",{staticClass:"text-danger",attrs:{role:"button"},on:{click:function(s){return e.unshareOne(t.subject)}}},[e._v(e._s(e.$t("pages.uma.resources.unshare")))])])],2)],1)],1)})),0):e._e()]),a("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("div",[a("b-button",{attrs:{type:"button",variant:"link"},on:{click:e.unshareAll}},[e._v(e._s(e.$t("pages.uma.resources.unshareAll")))]),e.newShare?a("div",{staticClass:"float-right"},[a("b-button",{attrs:{type:"button",variant:"outline-secondary mr-2"},on:{click:e.hideModal}},[e._v(e._s(e.$t("pages.uma.resources.cancel")))]),a("b-button",{attrs:{type:"button",variant:"primary"},on:{click:e.validateResource}},[e._v(e._s(e.$t("pages.uma.resources.share")))])],1):e._e()],1)])])},U=[],j={name:"Share",components:{"fr-fallback-image":u["a"]},props:["resource"],data:function(){return{newShare:!1,text:"Can "+this.resource.scopes[0],newScopes:{}}},created:function(){this.setNewScopes()},watch:{resource:function(){this.setNewScopes()}},methods:{setNewScopes:function(){var e=this;o.a.each(this.resource.scopes,(function(t){e.newScopes[t]=!0}))},hideModal:function(){this.$refs.fsModal.hide(),this.resetModal()},resetModal:function(){this.newShare="",this.setNewScopes()},unshareOne:function(e){var t=this.resetModal.bind(this),s=this.resource.policy.permissions.filter((function(t){return t.subject!==e})),a={policyId:this.resource._id,permissions:s};this.$emit("modifyResource",this.resource._id,a,{onSuccess:t,unshare:!0}),this.hideModal()},unshareAll:function(){this.$emit("renderUnshareModal",this.resource.name,this.resource._id),this.hideModal()},validateResource:function(){var e=this;if(this.resource.policy&&this.resource.policy.permissions){var t=o.a.findIndex(this.resource.policy.permissions,(function(t){return t.subject===e.newShare}));-1===t?this.newShare?this.shareResource():this.displayNotification("error",this.$t("pages.uma.resources.noRequestingParty")):(this.displayNotification("error",this.$t("pages.uma.resources.sameShareError",{requestingParty:this.newShare})),this.resetModal())}else!this.resource.policy&&this.newShare&&this.shareResource()},shareResource:function(){var e=this.resetModal.bind(this),t=this.newShare,s=o.a.keys(o.a.pickBy(this.newScopes)),a={subject:t,scopes:s},r={policyId:this.resource._id,permissions:[]};this.resource.policy?(r.permissions=this.resource.policy.permissions.filter((function(e){return e.subject!==t})),r.permissions.push(a),this.$emit("modifyResource",this.resource._id,r,{onSuccess:e})):(r.permissions.push(a),this.$emit("shareResource",r,{onSuccess:e})),this.hideModal()},modifyResource:function(e,t){var s=o.a.map(this.resource.policy.permissions,(function(s){if(s.subject===e){var a=s.scopes.length;s.scopes=o.a.filter(s.scopes,(function(e){return e!==t})),a===s.scopes.length&&s.scopes.push(t)}return s})),a={policyId:this.resource._id,permissions:s};this.$emit("modifyResource",this.resource._id,a)}}},A=j,I=(s("dfe1"),Object(g["a"])(A,E,U,!1,null,"145d1be8",null)),O=I.exports,F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-modal",{ref:"fsModal",attrs:{id:"unshareModal","cancel-variant":"outline-secondary"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.unshare(t))}}},[s("div",{staticClass:"d-flex w-100 h-100",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h6",{staticClass:"my-0"},[e._v(e._s(e.$t("pages.uma.resources.unshareResource",{resourceName:e.resourceName})))]),s("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:e.hideModal}},[s("i",{staticClass:"fa fa-times"})])]),e._v("\n    "+e._s(e.$t("pages.uma.resources.warningMessage"))+"\n    "),s("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("div",{staticClass:"float-right"},[s("b-btn",{attrs:{variant:"outline-secondary mr-2"},on:{click:e.hideModal}},[e._v(e._s(e.$t("pages.uma.resources.cancel")))]),s("b-btn",{attrs:{type:"button",variant:"danger"},on:{click:e.unshare}},[e._v(e._s(e.$t("pages.uma.resources.unshare")))])],1)])])},P=[],T={name:"Unshare",components:{},data:function(){return{}},props:["resourceId","resourceName"],methods:{hideModal:function(){this.$refs.fsModal.hide()},unshare:function(){this.$emit("unshareResource",this.resourceId),this.hideModal()}}},L=T,z=Object(g["a"])(L,F,P,!1,null,null,null),G=z.exports,Y={name:"Sharing",components:{"fr-activity":_,"fr-center-card":n["a"],"fr-requests":$,"fr-resources":D,"fr-share":O,"fr-unshare":G},data:function(){return{requestsLoaded:!1,resource:null,resourceId:"",resourceName:"",resources:[],activity:[],requests:[],resourcesCount:0,activityCount:0,delayedUpdate:!1}},computed:{amDataEndpoints:function(){var e={};return o.a.isNull(this.$root.applicationStore.state.amDataEndpoints)||(e=this.$root.applicationStore.state.amDataEndpoints),e},umaHistory:function(){var e=this;return o.a.map(this.activity,(function(t){var s=o.a.find(e.resources,{_id:t.resourceSetId});return o.a.has(s,"icon_uri")&&(t.icon_uri=s.icon_uri),t}))}},beforeMount:function(){this.loadData()},methods:{loadData:function(){this.getResources(),this.getActivity(),this.getRequests()},getResources:function(){var e=this,t=this.$root.userStore.state.userName,s="?_queryId=*",a=this.getRequestService(),r=this.amDataEndpoints.baseUrl+t+this.amDataEndpoints.resourceSet+s;a.get(r,{withCredentials:!0}).then((function(t){e.resources=t.data.result,e.requestsLoaded=!0})).catch((function(t){e.resources=[],e.requestsLoaded=!0,t.response?e.displayNotification("error",t.response.data.message):e.displayNotification("error",t.message)}))},getActivity:function(){var e=this,t=this.$root.userStore.state.userName,s="?_sortKeys=-eventTime&_queryFilter=true",a=this.getRequestService(),r=this.amDataEndpoints.baseUrl+t+this.amDataEndpoints.auditHistory+s;a.get(r,{withCredentials:!0}).then((function(t){e.activity=t.data.result})).catch((function(t){e.activity=[],t.response?e.displayNotification("error",t.response.data.message):e.displayNotification("error",t.message)}))},getRequests:function(){var e=this,t=this.$root.userStore.state.userName,s="?_sortKeys=user&_queryFilter=true",a=this.getRequestService(),r=this.amDataEndpoints.baseUrl+t+"/uma/pendingrequests"+s;a.get(r,{withCredentials:!0}).then((function(t){e.requests=o.a.map(t.data.result,(function(t){var s=o.a.find(e.resources,{name:t.resource});return o.a.has(s,"icon_uri")&&(t.icon_uri=s.icon_uri),o.a.has(s,"scopes")&&(t.scopes=s.scopes),t.allowed=!1,t.decision=!1,t}))})).catch((function(t){e.requests={},t.response?e.displayNotification("error",t.response.data.message):e.displayNotification("error",t.message)}))},renderShareModal:function(e){var t=this;this.resource=e,this.$nextTick((function(){t.$root.$emit("bv::show::modal","shareModal")}))},renderUnshareModal:function(e,t){var s=this;this.resourceName=e,this.resourceId=t,this.$nextTick((function(){s.$root.$emit("bv::show::modal","unshareModal")}))},shareResource:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.$root.userStore.state.userName,r=this.$t("common.user.sharing.shareSuccess"),i=this.getRequestService(),o=this.amDataEndpoints.baseUrl+a+"/uma/policies/"+e.policyId;i.put(o,e,{withCredentials:!0}).then((function(e){s.onSuccess&&s.onSuccess(),t.displayNotification("success",r),t.loadData()})).catch((function(e){t.displayNotification("error",e.response.data.message)}))},unshareResource:function(e){var t=this,s=this.$root.userStore.state.userName,a=this.$t("common.user.sharing.unshareSuccess"),r=this.getRequestService(),i=this.amDataEndpoints.baseUrl+s+"/uma/policies/"+e;r.delete(i,{withCredentials:!0}).then((function(e){t.displayNotification("success",a),t.loadData()})).catch((function(e){t.displayNotification("error",e.response.data.message)}))},modifyResource:function(e,t){var s=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=a.unshare?this.$t("common.user.sharing.unshareSuccess"):this.$t("common.user.sharing.modifySuccess"),i=this.$root.userStore.state.userName,o=this.amDataEndpoints.baseUrl+i+"/uma/policies/"+e,n=this.getRequestService(),c={"Accept-API-Version":"protocol=1.0,resource=1.0"};n.put(o,t,{withCredentials:!0,headers:c}).then((function(e){a.onSuccess&&a.onSuccess(),s.displayNotification("success",r),s.loadData()})).catch((function(e){s.displayNotification("error",e.response.data.message)}))},finalizeResourceAccess:function(e,t){var s=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.$root.userStore.state.userName,i="approve"===t?this.$t("common.user.sharing.requestAllowedSuccess"):this.$t("common.user.sharing.requestDeniedSuccess"),o=this.getRequestService(),n={scopes:a.scopes||{}},c="".concat(this.amDataEndpoints.baseUrl).concat(r,"/uma/pendingrequests/").concat(e,"?_action=").concat(t);o.post(c,n,{withCredentials:!0}).then((function(e){a.onSuccess&&a.onSuccess(),s.delayedUpdate=!0,s.displayNotification("success",i)})).catch((function(e){s.displayNotification("error",e.response.data.message)}))},testForReload:function(){!0===this.delayedUpdate&&(this.delayedUpdate=!1,this.loadData())}}},B=Y,W=Object(g["a"])(B,a,r,!1,null,"57594916",null);t["default"]=W.exports},"11be":function(e,t,s){"use strict";var a=s("eb53"),r=s.n(a);r.a},"13bf":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"px-0 h-100 d-flex",attrs:{fluid:""}},[a("div",{staticClass:"fr-m-auto fr-center-card align-self-center"},[a("b-card",{staticClass:"border-xs-0 border-sm d-flex fr-stretch-card",attrs:{"no-body":"","header-tag":"header","footer-tag":"footer"}},[a("b-card-header",{staticClass:"d-flex align-items-center flex-fill"},[a("div",{staticClass:"d-flex flex-fill flex-column justify-content-center"},[e.showLogo?a("b-img",{staticClass:"fr-logo mb-3 mt-2",attrs:{src:s("4acf"),fluid:"",alt:e.$t("common.form.logo")}}):e._e(),e._t("center-card-header")],2)]),e._t("center-card-body"),e._t("center-card-footer")],2)],1)])},r=[],i={name:"Center-Card",props:{showLogo:{type:Boolean,default:!1}}},o=i,n=(s("11be"),s("2877")),c=Object(n["a"])(o,a,r,!1,null,"ce41590c",null);t["a"]=c.exports},1824:function(e,t,s){e.exports=s.p+"img/empty-box.9516315b.svg"},"1f49":function(e,t,s){},"3a90":function(e,t,s){},"4acf":function(e,t,s){e.exports=s.p+"img/vertical-logo.fac466b9.svg"},5231:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-card",{staticClass:"mb-3",attrs:{"no-body":""}},[e._t("list-group-header",[s("b-card-body",{staticClass:"py-4"},[s("h5",{class:[{"mb-4":e.subtitle,"mb-0":!e.subtitle},"card-title"]},[e._v(e._s(e.title))]),e.subtitle?s("h6",{staticClass:"card-subtitle mb-0 text-muted"},[e._v(e._s(e.subtitle))]):e._e()])]),s("b-list-group",{attrs:{flush:""}},[e._t("default")],2)],2)},r=[],i={name:"List-Group",props:{title:{type:String},subtitle:{type:String}},data:function(){return{}}},o=i,n=(s("8fef"),s("2877")),c=Object(n["a"])(o,a,r,!1,null,"1e1858be",null);t["a"]=c.exports},"8fef":function(e,t,s){"use strict";var a=s("3a90"),r=s.n(a);r.a},9830:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.collapsible?s("div",{staticClass:"collapsible"},[s("b-list-group-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:e.toggleId,expression:"toggleId"}],class:[{"list-item-cursor":!1===e.collapsible}],attrs:{href:"#"}},[s("div",{staticClass:"media"},[e._t("list-item-header")],2)]),s("b-collapse",{attrs:{id:e.id,visible:e.panelShown},on:{hide:function(t){return e.$emit("hide")},show:function(t){return e.$emit("show")},hidden:function(t){return e.$emit("hidden")},shown:function(t){return e.$emit("shown")}}},[s("b-card-body",{staticClass:"pt-3"},[e._t("list-item-collapse-body")],2)],1)],1):s("div",{class:[{"fr-hover-item":e.hoverItem}],on:{click:function(t){return e.$emit("row-click")}}},[s("b-list-group-item",{staticClass:"noncollapse"},[s("div",{staticClass:"media"},[e._t("list-item-header")],2)]),e.panelShown?s("b-card-body",{staticClass:"pt-3"},[e._t("list-item-collapse-body")],2):e._e()],1)},r=[],i={name:"List-Item",props:{collapsible:{type:Boolean,default:!1},panelShown:{type:Boolean,default:!1},hoverItem:{type:Boolean,default:!1}},data:function(){return{id:null}},beforeMount:function(){this.id="listItem"+this._uid},computed:{toggleId:function(){return this.collapsible?this.id:null}}},o=i,n=(s("a617"),s("2877")),c=Object(n["a"])(o,a,r,!1,null,"cc9f6ae4",null);t["a"]=c.exports},9883:function(e,t,s){},a617:function(e,t,s){"use strict";var a=s("1f49"),r=s.n(a);r.a},c932:function(e,t,s){"use strict";var a=s("0602"),r=s.n(a);r.a},dfe1:function(e,t,s){"use strict";var a=s("9883"),r=s.n(a);r.a},eb53:function(e,t,s){}}]);
//# sourceMappingURL=chunk-642899e2.ddba0f1e.js.map