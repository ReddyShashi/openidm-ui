/*!
 * Copyright 2019 ForgeRock AS. All Rights Reserved 
 *  Use of this code requires a commercial software license with ForgeRock AS. or with one of its affiliates. All use shall be exclusively subject to such license between the licensee and ForgeRock AS.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e534177"],{"2d6f":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return null!==e.selfServiceType&&"parameters"!==e.selfServiceType?a("fr-center-card",{attrs:{showLogo:!0}},[a("div",{attrs:{slot:"center-card-header"},slot:"center-card-header"},[a("h2",{staticClass:"h2"},[e._v(e._s(e.$t("pages.selfservice.headers.reset.title")))])]),a("b-card-body",{attrs:{slot:"center-card-body"},slot:"center-card-body"},[a(e.selfServiceType,{ref:"selfServiceStage",tag:"component",attrs:{selfServiceDetails:e.selfServiceDetails,apiType:e.apiType},on:{advanceStage:e.advanceStage}})],1),a("b-card-footer",{attrs:{slot:"center-card-footer"},slot:"center-card-footer"},[a("b-link",{attrs:{href:"#/login"}},[e._v(e._s(e.$t("pages.selfservice.signIn")))])],1)],1):a("b-container",{staticClass:"h-100 px-0",attrs:{fluid:""}},[a("div",{staticClass:"h-100 d-flex"},[a("div",{staticClass:"m-auto fr-center-card"},[a("bounce-loader",{attrs:{color:e.loadingColor}})],1)])])},s=[],r=a("2ef0"),n=a.n(r),o=a("8455"),l=a("b107"),c=a.n(l),u=a("13bf"),p=a("5aa8"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-alert",{attrs:{show:""}},[e._v("\n    "+e._s(e.$t("pages.selfservice.headers."+e.apiType+".emailSent"))+"\n")])},f=[],m={name:"Email-Validation",props:{apiType:{required:!0}}},y=m,v=a("2877"),h=Object(v["a"])(y,d,f,!1,null,null,null),g=h.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form",{on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save(t)},submit:function(e){e.preventDefault()}}},[a("p",{staticClass:"text-center mb-4"},[e._v("\n        "+e._s(e.$t("pages.selfservice.passwordReset.kbaVerificationStageDescription"))+"\n    ")]),e._l(e.answers,(function(t,i){return a("div",{key:i,staticClass:"form-group text-left"},[a("label",{staticClass:"col-form-label pt-0 pb-2",attrs:{for:i}},[e._v(e._s(e.questionText[i]))]),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model.trim",value:e.answers[i],expression:"answers[key]",modifiers:{trim:!0}}],key:i,ref:i,refInFor:!0,class:{"form-control":!0,"is-invalid":e.errors.has(i)},attrs:{"data-vv-as":e.$t("common.user.kba.answer"),autofocus:"true",name:i,id:i},domProps:{value:e.answers[i]},on:{input:function(t){t.target.composing||e.$set(e.answers,i,t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),a("fr-validation-error",{attrs:{validatorErrors:e.errors,fieldName:i}})],1)})),a("b-button",{attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v("\n        "+e._s(e.$tc("common.user.kba.submitAnswers",e.selfServiceDetails.requirements.required.length))+"\n    ")])],2)},w=[],_=a("9588"),k={name:"Kba-Verification",inject:["$validator"],components:{"fr-validation-error":_["a"]},props:{selfServiceDetails:{required:!0}},data:function(){var e=this.$i18n,t=e.locale,a=e.fallbackLocale,i=this.selfServiceDetails.requirements,s=i.properties,r=i.required;return{questionText:n.a.mapValues(s,(function(e){if(n.a.has(e,"systemQuestion")){var i=e.systemQuestion[t]||e.systemQuestion[a];return i}if(n.a.has(e,"userQuestion"))return e.userQuestion})),answers:r.reduce((function(e,t){return n.a.set(e,t,"")}),{})}},mounted:function(){this.$refs&&this.$refs["answer1"]&&this.$refs["answer1"][0].focus()},methods:{emitData:function(){this.$emit("advanceStage",this.getData())},getData:function(){return this.answers},isValid:function(){return this.$validator.validateAll()},save:function(){var e=this;this.isValid().then((function(t){t&&e.emitData()}))}}},S=k,$=Object(v["a"])(S,b,w,!1,null,null,null),q=$.exports,C=a("5adf"),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return"end"===e.selfServiceDetails.tag?a("div",[a("b-alert",{attrs:{show:""}},[a("p",[e._v(e._s(e.$t("pages.selfservice.passwordReset.successMessage")))])])],1):"string"!==typeof e.selfServiceDetails.error?a("div",[a("b-form",{on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save(t)},submit:function(e){e.preventDefault()}}},[a("fr-policy-password-input",{attrs:{defaultPolicyFailures:e.defaultPolicyFailures,policyApi:"selfservice/reset",name:"password",label:e.$t("pages.selfservice.passwordReset.newPassword")},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("b-button",{attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v("\n            "+e._s(e.$t("pages.selfservice.passwordReset.changePassword"))+"\n        ")])],1)],1):a("div",[a("b-alert",{attrs:{variant:"danger",show:""}},[a("b",[e._v(e._s(e.$t("pages.selfservice.passwordReset.errorMessage")))]),a("p",[e._v(e._s(e.selfServiceDetails.error))])]),a("div",{staticClass:"mt-2"},[a("a",{attrs:{href:"#/passwordreset"},on:{click:e.reloadPage}},[e._v(e._s(e.$t("pages.selfservice.passwordReset.tryAgain")))])])],1)},P=[],D=a("f8f2"),R={name:"Reset-Stage",components:{"fr-policy-password-input":D["a"]},props:{selfServiceDetails:{required:!0}},data:function(){return{password:"",defaultPolicyFailures:null}},methods:{getData:function(){return{password:this.password}},save:function(){this.$emit("advanceStage",this.getData())},reloadPage:function(e){e.preventDefault();var t=window.location.hash;window.location.hash=t.substr(0,t.lastIndexOf("/")+1),window.location.reload()}},watch:{selfServiceDetails:{handler:function(e){if(Object(r["has"])(e,"requirements.error.detail.failedPolicyRequirements")){var t=Object(r["find"])(e.requirements.error.detail.failedPolicyRequirements,{property:"password"});if(t&&t.policyRequirements){var a=this.$t("common.policyValidationMessages.".concat(t.policyRequirements[0].policyRequirement),t.policyRequirements[0].params),i="".concat(this.$t("common.policyValidationMessages.policyValidationFailed",{property:t.property}),": ").concat(a);this.displayNotification("error",i),this.defaultPolicyFailures=Object(r["map"])(t.policyRequirements,"policyRequirement")}}},deep:!0}}},F=R,E=Object(v["a"])(F,x,P,!1,null,null,null),T=E.exports,O=a("e5d2"),A=a("3b97"),V={name:"Password-Reset",components:{Captcha:p["a"],EmailValidation:g,UserQuery:A["a"],ResetStage:T,kbaSecurityAnswerVerificationStage:q,GenericSelfService:C["a"],"bounce-loader":o["BounceLoader"],"fr-center-card":u["a"]},data:function(){return{selfServiceType:null,selfServiceDetails:null,loadingColor:c.a.baseColor,apiType:"reset"}},mounted:function(){if(this.$route.params.queryParams){var e=this.parseQueryParams(this.$route.params.queryParams);this.advanceStage(e)}else this.loadData()},methods:{setChildComponent:function(e,t){if(this.selfServiceDetails=t,"parameters"===e)this.selfServiceType=null,this.advanceStage({});else{var a=!1;n.a.each(this.$options.components,(function(t,i){n.a.toLower(i)===n.a.toLower(e)&&(a=!0)})),this.selfServiceType=a?e:"GenericSelfService"}},apiErrorCallback:function(e){this.setChildComponent("resetStage",{error:e.response.data.message})}},mixins:[O["a"]]},j=V,N=Object(v["a"])(j,i,s,!1,null,null,null);t["default"]=N.exports},"3b97":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form",{on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save(t)},submit:function(e){e.preventDefault()}}},[a("p",{staticClass:"text-center mb-4"},[e._v("\n        "+e._s(e.$t("pages.selfservice.passwordReset.userQuery"))+"\n    ")]),a("b-form-group",[a("fr-floating-label-input",{attrs:{fieldName:"mail",label:e.$t("common.placeholders.emailAddress"),type:"text",autofocus:"true"},model:{value:e.mail,callback:function(t){e.mail=t},expression:"mail"}})],1),a("b-button",{attrs:{size:"lg",block:!0,variant:"primary"},on:{click:e.save}},["username"===e.apiType?a("div",[e._v("\n            "+e._s(e.$t("pages.selfservice.forgotUsername.advanceStageButtonText"))+"\n        ")]):a("div",[e._v("\n            "+e._s(e.$t("pages.selfservice.passwordReset.advanceStageButtonText"))+"\n        ")])])],1)},s=[],r=a("49c6"),n={name:"User-Query",components:{"fr-floating-label-input":r["a"]},props:{apiType:{required:!0}},data:function(){return{mail:""}},methods:{getData:function(){return{queryFilter:'mail eq "'.concat(this.mail,'"')}},save:function(){this.$emit("advanceStage",this.getData())}}},o=n,l=a("2877"),c=Object(l["a"])(o,i,s,!1,null,null,null);t["a"]=c.exports},"5aa8":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mb-4",attrs:{id:"captchaBody"}},[e.apiType?a("p",{staticClass:"text-center mb-4"},[e._v("\n        "+e._s(e.$t("pages.selfservice.headers."+e.apiType+".description"))+"\n    ")]):e._e(),e._m(0)])},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"recaptcha-wrapper "},[a("div",{staticClass:"recaptcha-bound"},[a("div",{attrs:{id:"recaptchaContainer"}})])])}],r=a("2ef0"),n=a.n(r),o={name:"Captcha",props:{advanceStage:{required:!1},selfServiceDetails:{required:!0},apiType:{required:!1}},created:function(){var e=document.createElement("script");e.setAttribute("src","https://www.google.com/recaptcha/api.js"),document.head.appendChild(e)},mounted:function(){this.loadRecaptcha()},methods:{loadRecaptcha:function(){var e=this;n.a.isUndefined(this.selfServiceDetails.requirements.properties.response.recaptchaSiteKey)||0===this.selfServiceDetails.requirements.properties.response.recaptchaSiteKey.length?this.displayNotification("error",this.$t("pages.selfservice.captchaError")):setTimeout((function(){"undefined"===typeof window.grecaptcha?e.loadRecaptcha():window.grecaptcha.render("recaptchaContainer",{sitekey:e.selfServiceDetails.requirements.properties.response.recaptchaSiteKey,callback:e.handleCaptchaCallback})}),500)},handleCaptchaCallback:function(e){this.recaptchaResponse=e,this.$listeners.advanceStage&&this.$emit("advanceStage",this.getData())},getData:function(){return{response:this.recaptchaResponse,"g-recaptcha-response":this.recaptchaResponse}}}},l=o,c=a("2877"),u=Object(c["a"])(l,i,s,!1,null,null,null);t["a"]=u.exports},"5adf":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.displayDetails,(function(t,i){return["string"===t.type||"number"===t.type?a("b-form-group",{key:"genericField"+i,attrs:{label:e._f("startCase")(t.key),"label-for":"field.key",horizontal:""}},["string"===t.type?a("b-form-input",{ref:0===i?"focusInput":"",refInFor:!0,attrs:{name:t.key,placeholder:t.text,type:"text",autocomplete:t.key},model:{value:e.saveFields[t.key],callback:function(a){e.$set(e.saveFields,t.key,"string"===typeof a?a.trim():a)},expression:"saveFields[field.key]"}}):e._e(),"number"===t.type?a("b-form-input",{ref:0===i?"focusInput":"",refInFor:!0,attrs:{horizontal:"",name:t.key,type:"number",autocomplete:t.key},model:{value:e.saveFields[t.key],callback:function(a){e.$set(e.saveFields,t.key,e._n(a))},expression:"saveFields[field.key]"}}):e._e()],1):e._e(),"boolean"===t.type?a("b-form-group",{key:"genericField"+i},[a("div",{staticClass:"form-row"},[a("label",{staticClass:"col-form-label col-sm-3",attrs:{for:t.key}},[e._v(e._s(e._f("startCase")(t.key)))]),a("div",{staticClass:"mr-auto"},[a("toggle-button",{staticClass:"mt-2 p-0 fr-toggle-primary",attrs:{height:28,width:56,sync:!0,cssColors:!0},model:{value:e.saveFields[t.key],callback:function(a){e.$set(e.saveFields,t.key,a)},expression:"saveFields[field.key]"}})],1)])]):e._e()]})),a("b-button",{staticClass:"mt-4",attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v("\n        "+e._s(e.$t("common.form.submit"))+"\n    ")])],2)},s=[],r=a("2ef0"),n=a.n(r),o={name:"Generic-Self-Service",props:{selfServiceDetails:{required:!0}},data:function(){var e={},t=[];return this.selfServiceDetails&&this.selfServiceDetails.requirements&&this.selfServiceDetails.requirements.properties&&n.a.each(this.selfServiceDetails.requirements.properties,(function(a,i){t.push({type:a.type,text:a.description,key:i}),"string"===a.type?e[i]="":"boolean"===a.type?e[i]=!1:e[i]=null})),{saveFields:e,displayDetails:t}},methods:{getData:function(){return this.saveFields},save:function(){this.$emit("advanceStage",this.getData())},isValid:function(){return Promise.resolve(!0)}},filters:{startCase:function(e){return n.a.startCase(e)}}},l=o,c=a("2877"),u=Object(c["a"])(l,i,s,!1,null,"bd6ef798",null);t["a"]=u.exports},7840:function(e,t,a){"use strict";var i=a("ca70"),s=a.n(i);s.a},ca70:function(e,t,a){},f8f2:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form-group",{staticClass:"mb-0"},[e.customInput?[e._t("custom-input"),a("fr-policy-panel",{attrs:{policies:e.policies,policyFailures:e.showDefaultPolicyFailures?e.defaultPolicyFailures:e.policyFailures}})]:e._t("input-with-validation-panel",[a("fr-floating-label-input",{directives:[{name:"validate",rawName:"v-validate.initial",value:"required|policy",expression:"'required|policy'",modifiers:{initial:!0}}],attrs:{name:"password",fieldName:"password",type:"password",label:e.label||e.$t("common.placeholders.password"),reveal:!0,showErrorState:!1},on:{input:function(t){return e.$emit("input",t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}},[a("fr-policy-panel",{attrs:{slot:"validationError",policies:e.policies,policyFailures:e.showDefaultPolicyFailures?e.defaultPolicyFailures:e.policyFailures},slot:"validationError"})],1)])],2)},s=[],r=a("2ef0"),n=a.n(r),o=a("49c6"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card border-0 mt-3"},[a("transition",{attrs:{name:"fade",mode:"out-in",duration:150}},[e.isLoading?e._e():[e.isValid?a("div",{staticClass:"alert alert-success mt-1",attrs:{role:"alert"}},[a("i",{staticClass:"fa fa-check-circle"}),e._v(" "+e._s(e.$t("common.policyValidationMessages.successMessages.password"))+"\n            ")]):a("ul",{staticClass:"text-left pl-3"},e._l(e.policies,(function(t){return a("li",{key:t.policyId,class:[{"fr-valid":!e.includes(e.policyFailures,t.name)},"text-primary fr-policy-list-item"]},[a("small",{staticClass:"text-body"},[e._v(e._s(e.translate(t)))])])})),0)]],2)],1)},c=[],u={name:"PolicyPanel",props:["policies","policyFailures"],data:function(){return{}},computed:{isValid:function(){return n.a.isArray(this.policyFailures)&&n.a.isEmpty(this.policyFailures)},isLoading:function(){return"loading"===this.policyFailures||!1===this.policyFailures}},methods:{translate:function(e){var t="common.policyValidationMessages.".concat(e.name);return this.$t(t,e.params)},includes:n.a.includes},watch:{policyFailures:function(e){this.policyFailures=e}}},p=u,d=(a("7840"),a("2877")),f=Object(d["a"])(p,l,c,!1,null,"8583d52e",null),m=f.exports,y={name:"PolicyPasswordInput",inject:["$validator"],components:{"fr-floating-label-input":o["a"],"fr-policy-panel":m},props:{policyApi:{required:!0,type:String},defaultPolicyFailures:{required:!1,type:Array},value:String,label:String,exclude:{required:!1,type:Array,default:function(){var e=this.policyApi;return[{name:"REQUIRED",predicate:function(e){return n.a.includes(e,"REQUIRED")&&n.a.includes(e,"MIN_LENGTH")}},{name:"IS_NEW",predicate:function(t){return"selfservice/registration"===e}},"VALID_TYPE","CANNOT_CONTAIN_OTHERS"]}}},data:function(){return{policies:[],password:this.value,failedExcludedPolicies:[],showDefaultPolicyFailures:!1}},watch:{failedExcludedPolicies:function(e){var t=e[0];if(t){var a=this.$t("common.policyValidationMessages.".concat(t.policyRequirements[0].policyRequirement),t.policyRequirements[0].params),i="".concat(this.$t("common.policyValidationMessages.policyValidationFailed",{property:t.property}),": ").concat(a);this.displayNotification("error",i),this.failedExcludedPolicies=[]}},defaultPolicyFailures:function(e){this.showDefaultPolicyFailures=!0}},computed:{policyFailures:function(){var e=this.errors.firstByRule("password","policy");return n.a.isUndefined(this.fields.password)?"loading":n.a.isNull(e)&&this.fields.password.valid?[]:e},customInput:function(){return!n.a.isUndefined(this.$slots["custom-input"])}},methods:{isPasswordPolicyItem:n.a.curry((function(e,t){return!n.a.isEmpty(t[e].match("password"))})),toSimplePolicyObject:function(e){var t=e.policyRequirements,a=e.params,i=n.a.first(t);return n.a.isUndefined(i)?{}:{name:i,params:a}},toPolicyNames:function(e){var t=e.failedPolicyRequirements||[],a=t.filter(this.isPasswordPolicyItem("property")).map((function(e){return n.a.at(e,["policyRequirements[0].policyRequirement"])}));return n.a.flatten(a)},makeExclusions:function(e){var t,a;t=e&&e.policyRequirements?e.policyRequirements:[],a=e&&e.policies?e.policies:[];var i=function(e){return n.a.reject(a,(function(t){return n.a.first(t.policyRequirements)===e}))};return this.exclude.forEach((function(e){n.a.isObject(e)?e.predicate(t)&&(a=i(e.name)):n.a.isString(e)&&n.a.includes(t,e)&&(a=i(e))})),Object.assign({},e,{policyRequirements:t,policies:a})},formatPayload:function(e){return this.policyApi.match("registration")?{user:{password:e}}:{password:e}},getAction:function(){return this.policyApi.match("selfservice")?"validateObject":"validateProperty"}},created:function(){var e=this,t=this.getAnonymousHeaders(),a=this.getRequestService({headers:t}),i=this.formatPayload.bind(this),s=function(e){var t=this,s=i(e);return a.post("/policy/".concat(this.policyApi,"/?_action=").concat(this.getAction()),s).then((function(e){var a=e.data;return a.failedPolicyRequirements&&n.a.map(a.failedPolicyRequirements,(function(e){"password"===e.property&&(t.showDefaultPolicyFailures=!1,n.a.includes(t.exclude,e.policyRequirements[0].policyRequirement)&&t.failedExcludedPolicies.push(e))})),t.toPolicyNames(a)})).catch((function(){t.displayNotification("error",t.$t("common.policyValidationMessages.policyServiceError"))}))}.bind(this);this.$validator.extend("policy",{validate:function(e,t){return s(e).then((function(e){return{valid:n.a.isEmpty(e),data:e}}))},getMessage:function(e,t,a){return a}}),a.get("/policy/".concat(this.policyApi)).then((function(t){var a=t.data;return n.a.head(a.properties.filter(e.isPasswordPolicyItem("name")))})).then((function(t){return e.makeExclusions(t)})).then((function(t){var a=t.policies;e.policies=a.map(e.toSimplePolicyObject).filter((function(e){return!n.a.isEmpty(e)}))})).catch((function(){e.displayNotification("error",e.$t("common.policyValidationMessages.policyServiceError.".concat(e.policyApi))),e.$router.push("/login")}))}},v=y,h=Object(d["a"])(v,i,s,!1,null,null,null);t["a"]=h.exports}}]);
//# sourceMappingURL=chunk-2e534177.81216d35.js.map